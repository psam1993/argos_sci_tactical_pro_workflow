<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recursos | ARGOS SCI</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body>
    <aside class="sidebar">
        <div class="brand"><i data-lucide="shield"></i> <span>ARGOS SCI</span></div>
        <nav class="nav">
            <a href="index.html"><i data-lucide="layout-dashboard"></i> <span>Dashboard</span></a>
            <a href="incidente.html"><i data-lucide="file-text"></i> <span>Configura√ß√£o SCI</span></a>
            <a href="mapa.html"><i data-lucide="map"></i> <span>Mapa T√°tico</span></a>
            <a href="workflow.html"><i data-lucide="git-merge"></i> <span>Workflow PO</span></a>
            <a href="painel_papel.html"><i data-lucide="user-cog"></i> <span>Painel por Papel</span></a>
            <a href="planejamento.html"><i data-lucide="clipboard-list"></i> <span>Planejamento</span></a>
            <a href="operacoes.html"><i data-lucide="swords"></i> <span>Opera√ß√µes</span></a>
            <a href="logistica.html"><i data-lucide="truck"></i> <span>Log√≠stica</span></a>
            <a href="admfin.html"><i data-lucide="wallet"></i> <span>Adm/Fin</span></a>
            <a href="seguranca.html"><i data-lucide="hard-hat"></i> <span>Seguran√ßa</span></a>
            <a href="informacao_publica.html"><i data-lucide="megaphone"></i> <span>Info P√∫blica</span></a>
            <a href="ligacoes.html"><i data-lucide="handshake"></i> <span>Liga√ß√µes</span></a>
            <a href="equipes.html"><i data-lucide="users"></i> <span>Recursos</span></a>
            <a href="relatorios.html"><i data-lucide="printer"></i> <span>Relat√≥rios / PAI</span></a>
        </nav>
        <div style="background: #ffffff05; padding: 15px; border-radius: 10px; margin-top: 20px;">
            <div class="badge badge-ok" style="margin-bottom: 5px;">Sistema Online</div>
            <div style="font-size: 11px; color: var(--muted);">Cuiab√°/MT - Recursos</div>
        </div>
    </aside>
    <div class="main">
        <header class="topbar">
            <div style="display:flex; gap: 20px; align-items:center;">
                <span class="muted" style="font-size: 13px;">INCIDENTE ATIVO:</span> 
                <strong style="letter-spacing: 0.5px;">#SCI-2026-004</strong>
            </div>
            <div style="display:flex; gap: 20px; align-items:center;">
                <div style="text-align: right; line-height: 1.2;">
                    <div style="font-size: 12px; font-weight: 700; color: var(--warn);">PO-02 EM CURSO</div>
                    <div class="muted" style="font-size: 10px;">FECHAMENTO: 14 JAN 06:00</div>
                </div>
                <div style="width:38px; height:38px; background:var(--brand); border-radius:10px; display:grid; place-items:center; font-weight:bold; color:#000; cursor:pointer;">RS</div>
            </div>
        </header>
        <section class="content">
<div class="card">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <div>
            <h2><i data-lucide="package"></i> Gerenciamento Unificado de Recursos</h2>
            <p class="muted" style="margin-top:8px; font-size:12px;">Gest√£o centralizada de guarni√ß√µes, equipamentos, maquin√°rios e materiais envolvidos na opera√ß√£o.</p>
        </div>
        <button class="btn btn-primary" onclick="openAddResourceModal()"><i data-lucide="plus"></i> Adicionar Recurso</button>
    </div>

    <!-- OBSERVA√á√ÉO IMPORTANTE -->
    <div style="background:linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); padding:16px; border-radius:10px; margin-bottom:20px; border-left:4px solid #d97706;">
        <div style="display:flex; gap:12px; align-items:flex-start;">
            <i data-lucide="info" style="width:20px; height:20px; color:#fff; flex-shrink:0; margin-top:2px;"></i>
            <div>
                <strong style="color:#fff; display:block; margin-bottom:6px;">Guarni√ß√µes da Ordem de Servi√ßo ARGOS</strong>
                <div style="font-size:13px; color:#fffbeb; line-height:1.6;">As guarni√ß√µes provenientes da Ordem de Servi√ßo (OS) do ARGOS ser√£o automaticamente integradas como recursos no sistema. Todos os recursos (humanos, equipamentos, maquin√°rios e materiais) s√£o gerenciados de forma unificada e simplificada, com rastreamento de status, localiza√ß√£o e respons√°vel.</div>
            </div>
        </div>
    </div>

    <!-- FILTROS E CATEGORIAS -->
    <div style="display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap;">
        <button class="btn btn-secondary" onclick="filterResources('all')" id="filter_all" style="background:var(--brand);">Todos</button>
        <button class="btn btn-secondary" onclick="filterResources('guarnicao')">üë• Guarni√ß√µes</button>
        <button class="btn btn-secondary" onclick="filterResources('equipamento')">üîß Equipamentos</button>
        <button class="btn btn-secondary" onclick="filterResources('maquinario')">‚öôÔ∏è Maquin√°rios</button>
        <button class="btn btn-secondary" onclick="filterResources('material')">üì¶ Materiais</button>
    </div>

    <!-- TABELA DE RECURSOS -->
    <table class="table" id="resources_table">
        <thead>
            <tr>
                <th>ID / Nome</th>
                <th>Categoria</th>
                <th>Respons√°vel</th>
                <th>Status</th>
                <th>Localiza√ß√£o</th>
                <th>A√ß√µes</th>
            </tr>
        </thead>
        <tbody id="resources_list">
            <!-- Preenchido por JavaScript -->
        </tbody>
    </table>

    <!-- RESUMO ESTAT√çSTICO -->
    <div style="margin-top:30px; display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:12px;">
        <div style="padding:12px; background:#ffffff05; border-radius:8px; border-left:3px solid #3B82F6;">
            <div class="muted" style="font-size:12px;">Guarni√ß√µes Total</div>
            <div style="font-size:24px; font-weight:700; margin-top:4px;" id="stat_guarnicions">0</div>
        </div>
        <div style="padding:12px; background:#ffffff05; border-radius:8px; border-left:3px solid #10B981;">
            <div class="muted" style="font-size:12px;">Equipamentos Ativos</div>
            <div style="font-size:24px; font-weight:700; margin-top:4px;" id="stat_equipamentos">0</div>
        </div>
        <div style="padding:12px; background:#ffffff05; border-radius:8px; border-left:3px solid #F59E0B;">
            <div class="muted" style="font-size:12px;">Maquin√°rios em Uso</div>
            <div style="font-size:24px; font-weight:700; margin-top:4px;" id="stat_maquinarios">0</div>
        </div>
        <div style="padding:12px; background:#ffffff05; border-radius:8px; border-left:3px solid #8B5CF6;">
            <div class="muted" style="font-size:12px;">Materiais Registrados</div>
            <div style="font-size:24px; font-weight:700; margin-top:4px;" id="stat_materiais">0</div>
        </div>
    </div>
</div>

<!-- MODAL PARA ADICIONAR/EDITAR RECURSO -->
<div id="resource_modal" style="display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.6); z-index:1000; align-items:center; justify-content:center;">
    <div style="background:#1a1a2e; border:1px solid var(--border); border-radius:12px; padding:24px; width:90%; max-width:600px; max-height:90vh; overflow-y:auto; box-shadow:0 10px 40px rgba(0,0,0,0.5);">
        <h3 style="margin-top:0;">Adicionar/Editar Recurso</h3>
        
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:16px;">
            <div>
                <label>ID/Nome do Recurso *</label>
                <input id="resource_id" placeholder="Ex: GUA-01, AER-01, BOM-02" style="padding:8px; border:1px solid var(--border); border-radius:6px; background:var(--surface); width:100%; box-sizing:border-box;">
            </div>
            <div>
                <label>Categoria *</label>
                <select id="resource_category" style="padding:8px; border:1px solid var(--border); border-radius:6px; background:var(--surface); width:100%; box-sizing:border-box;">
                    <option value="">Selecione...</option>
                    <option value="guarnicao">üë• Guarni√ß√£o (Humana)</option>
                    <option value="equipamento">üîß Equipamento (EPI, Ferramentas)</option>
                    <option value="maquinario">‚öôÔ∏è Maquin√°rio (Ve√≠culos, A√©reos)</option>
                    <option value="material">üì¶ Material (Suprimentos, Insumos)</option>
                </select>
            </div>
        </div>

        <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:16px;">
            <div>
                <label>Respons√°vel</label>
                <input id="resource_responsible" placeholder="Nome do respons√°vel" style="padding:8px; border:1px solid var(--border); border-radius:6px; background:var(--surface); width:100%; box-sizing:border-box;">
            </div>
            <div>
                <label>Status *</label>
                <select id="resource_status" style="padding:8px; border:1px solid var(--border); border-radius:6px; background:var(--surface); width:100%; box-sizing:border-box;">
                    <option value="disponivel">‚úÖ Dispon√≠vel</option>
                    <option value="em_operacao">‚ö†Ô∏è Em Opera√ß√£o</option>
                    <option value="prontidao">üîî Prontid√£o</option>
                    <option value="manutencao">üîß Manuten√ß√£o</option>
                    <option value="indisponivel">‚ùå Indispon√≠vel</option>
                </select>
            </div>
        </div>

        <div style="margin-bottom:16px;">
            <label>Localiza√ß√£o/Observa√ß√µes</label>
            <textarea id="resource_location" placeholder="Ex: Flanco Norte - Aceiro, Base Central, etc." rows="3" style="padding:8px; border:1px solid var(--border); border-radius:6px; background:var(--surface); width:100%; box-sizing:border-box;"></textarea>
        </div>

        <div style="display:flex; gap:10px; justify-content:flex-end;">
            <button class="btn btn-secondary" onclick="closeResourceModal()">Cancelar</button>
            <button class="btn btn-primary" onclick="saveResource()">Salvar Recurso</button>
        </div>
    </div>
</div>

<script>
let currentResourceEdit = null;
let allResources = [];

// Dados de exemplo iniciais
const DEFAULT_RESOURCES = [
    {id: 'GUA-01', category: 'guarnicao', responsible: 'Sgt. Oliveira', status: 'em_operacao', location: 'Flanco Norte - Aceiro'},
    {id: 'GUA-02', category: 'guarnicao', responsible: 'Sgt. Mendes', status: 'em_operacao', location: 'Flanco Leste - Conten√ß√£o'},
    {id: 'GUA-03', category: 'guarnicao', responsible: 'Cabo Silva', status: 'prontidao', location: 'Base - Reserva Estrat√©gica'},
    {id: 'GUA-04', category: 'guarnicao', responsible: 'Sgt. Rocha', status: 'em_operacao', location: 'Setor Central - Prote√ß√£o TX'},
    {id: 'GUA-05', category: 'guarnicao', responsible: 'Sgt. Santos', status: 'disponivel', location: 'Base PCA - Abastecimento'},
    {id: 'GUA-06', category: 'guarnicao', responsible: 'Cb. Costa', status: 'disponivel', location: 'Base - Suprimentos'},
    {id: 'AER-01', category: 'maquinario', responsible: 'Cap. Freitas', status: 'manutencao', location: 'Hangar Municipal - Retorno 16:00h'},
    {id: 'AMB-02', category: 'guarnicao', responsible: 'Ten. Ana', status: 'prontidao', location: 'PC Central - Pronta para Evacua√ß√£o'},
];

function getStatusBadge(status) {
    const statusMap = {
        'disponivel': {class: 'badge-ok', text: '‚úÖ Dispon√≠vel'},
        'em_operacao': {class: 'badge-warn', text: '‚ö†Ô∏è Em Opera√ß√£o'},
        'prontidao': {class: 'badge-info', text: 'üîî Prontid√£o'},
        'manutencao': {class: 'badge-danger', text: 'üîß Manuten√ß√£o'},
        'indisponivel': {class: 'badge-danger', text: '‚ùå Indispon√≠vel'}
    };
    const s = statusMap[status] || {class: 'badge-muted', text: status};
    return `<span class="badge ${s.class}">${s.text}</span>`;
}

function getCategoryLabel(category) {
    const labels = {
        'guarnicao': 'üë• Guarni√ß√£o',
        'equipamento': 'üîß Equipamento',
        'maquinario': '‚öôÔ∏è Maquin√°rio',
        'material': 'üì¶ Material'
    };
    return labels[category] || category;
}

function loadResources() {
    const saved = Store.get('resources_inventory', null);
    allResources = saved || DEFAULT_RESOURCES;
    renderResources();
}

function renderResources(filterCategory = 'all') {
    const filtered = filterCategory === 'all' ? allResources : allResources.filter(r => r.category === filterCategory);
    
    const html = filtered.map(r => `
        <tr>
            <td><strong>${r.id}</strong></td>
            <td>${getCategoryLabel(r.category)}</td>
            <td>${r.responsible || '‚Äî'}</td>
            <td>${getStatusBadge(r.status)}</td>
            <td><span style="font-size:12px;">${r.location || '‚Äî'}</span></td>
            <td>
                <button class="btn btn-secondary" onclick="editResource('${r.id}')" style="padding:4px 8px; font-size:11px;">‚úèÔ∏è Editar</button>
                <button class="btn btn-secondary" onclick="deleteResource('${r.id}')" style="padding:4px 8px; font-size:11px; color:#ef4444;">üóëÔ∏è Remover</button>
            </td>
        </tr>
    `).join('');
    
    document.getElementById('resources_list').innerHTML = html || '<tr><td colspan="6" class="muted" style="text-align:center;">Nenhum recurso encontrado.</td></tr>';
    
    // Atualizar estat√≠sticas
    updateStats();
}

function filterResources(category) {
    document.querySelectorAll('#resources_table button').forEach(btn => btn.style.background = '');
    document.getElementById('filter_' + category).style.background = 'var(--brand)';
    renderResources(category);
}

function openAddResourceModal() {
    currentResourceEdit = null;
    document.getElementById('resource_id').value = '';
    document.getElementById('resource_category').value = '';
    document.getElementById('resource_responsible').value = '';
    document.getElementById('resource_status').value = 'disponivel';
    document.getElementById('resource_location').value = '';
    const modal = document.getElementById('resource_modal');
    modal.style.display = 'flex';
}

function closeResourceModal() {
    document.getElementById('resource_modal').style.display = 'none';
}

function saveResource() {
    const id = document.getElementById('resource_id').value.trim().toUpperCase();
    const category = document.getElementById('resource_category').value;
    const responsible = document.getElementById('resource_responsible').value.trim();
    const status = document.getElementById('resource_status').value;
    const location = document.getElementById('resource_location').value.trim();
    
    if(!id || !category) {
        ARGOS.toast('ID e Categoria s√£o obrigat√≥rios.');
        return;
    }
    
    if(currentResourceEdit === null) {
        if(allResources.find(r => r.id === id)) {
            ARGOS.toast('Recurso com este ID j√° existe.');
            return;
        }
        allResources.unshift({id, category, responsible, status, location});
    } else {
        const idx = allResources.findIndex(r => r.id === currentResourceEdit);
        if(idx >= 0) {
            allResources[idx] = {id, category, responsible, status, location};
        }
    }
    
    Store.set('resources_inventory', allResources);
    renderResources();
    closeResourceModal();
    ARGOS.toast('Recurso salvo com sucesso.');
}

function editResource(resourceId) {
    const resource = allResources.find(r => r.id === resourceId);
    if(!resource) return;
    
    currentResourceEdit = resourceId;
    document.getElementById('resource_id').value = resource.id;
    document.getElementById('resource_category').value = resource.category;
    document.getElementById('resource_responsible').value = resource.responsible || '';
    document.getElementById('resource_status').value = resource.status;
    document.getElementById('resource_location').value = resource.location || '';
    const modal = document.getElementById('resource_modal');
    modal.style.display = 'flex';
}

function deleteResource(resourceId) {
    if(!confirm(`Remover recurso ${resourceId}?`)) return;
    allResources = allResources.filter(r => r.id !== resourceId);
    Store.set('resources_inventory', allResources);
    renderResources();
    ARGOS.toast('Recurso removido.');
}

function updateStats() {
    const categories = {
        'guarnicao': 0,
        'equipamento': 0,
        'maquinario': 0,
        'material': 0
    };
    
    allResources.forEach(r => {
        if(categories.hasOwnProperty(r.category)) {
            categories[r.category]++;
        }
    });
    
    document.getElementById('stat_guarnicions').textContent = categories.guarnicao;
    document.getElementById('stat_equipamentos').textContent = categories.equipamento;
    document.getElementById('stat_maquinarios').textContent = categories.maquinario;
    document.getElementById('stat_materiais').textContent = categories.material;
}

document.addEventListener('DOMContentLoaded', () => {
    loadResources();
});
</script>
</section>
    </div>
    <script src="assets/data-plano-acao.js"></script>
    <script src="assets/app.js"></script>
</body>
</html>
